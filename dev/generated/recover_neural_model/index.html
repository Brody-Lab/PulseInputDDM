<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Fitting a neural model · pulse input DDM</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><nav class="toc"><a href="../../"><img class="logo" src="../../assets/logo.png" alt="pulse input DDM logo"/></a><h1>pulse input DDM</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><span class="toctext">Home</span><ul><li><a class="toctext" href="../../">pulse input DDM</a></li></ul></li><li><span class="toctext">Basics</span><ul><li><a class="toctext" href="../../man/getting_the_package/">Getting started</a></li><li><a class="toctext" href="../../man/choice_observation_model/">Fitting the model to choices</a></li><li><a class="toctext" href="../../man/neural_observation_model/">Fitting the model to neural activity</a></li><li><a class="toctext" href="../recover_choice_model/">Fitting a choice model</a></li><li class="current"><a class="toctext" href>Fitting a neural model</a><ul class="internal"></ul></li></ul></li><li><span class="toctext">Other helpful info</span><ul><li><a class="toctext" href="../../man/vpn_is_annoying/">Efficient Remote SSH</a></li></ul></li><li><span class="toctext">Development</span><ul><li><a class="toctext" href="../../man/development/">Developing the code</a></li></ul></li><li><span class="toctext">Index</span><ul><li><a class="toctext" href="../../links/">Index</a></li></ul></li><li><span class="toctext">Functions</span><ul><li><a class="toctext" href="../../functions/">Functions</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Basics</li><li><a href>Fitting a neural model</a></li></ul><a class="edit-page" href="https://github.com/Brody-Lab/pulse_input_DDM/blob/master/examples/recover_neural_model.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Fitting a neural model</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Fitting-a-neural-model-1" href="#Fitting-a-neural-model-1">Fitting a neural model</a></h1><p>Blah blah blah</p><pre><code class="language-julia">using pulse_input_DDM</code></pre><h3><a class="nav-anchor" id="Geneerate-some-data-1" href="#Geneerate-some-data-1">Geneerate some data</a></h3><p>Blah blah blah</p><pre><code class="language-julia">f, ncells, ntrials, nparams = &quot;Sigmoid&quot;, [1,2], [10,5], 4

θ_syn = θneural(θz = θz(σ2_i = 0.5, B = 15., λ = -0.5, σ2_a = 10., σ2_s = 1.2,
    ϕ = 0.6, τ_ϕ =  0.02),
    θy=[[Sigmoid() for n in 1:N] for N in ncells], ncells=ncells,
    nparams=nparams, f=f)

data = synthetic_data(θ_syn, ntrials);</code></pre><h3><a class="nav-anchor" id="Optimize-stuff-1" href="#Optimize-stuff-1">Optimize stuff</a></h3><p>Blah blah blah</p><pre><code class="language-julia">n = 53

θy0 = vcat(vcat(initialize_θy.(data, f)...)...)

options0 = neuraloptions(ncells=ncells,
    fit=vcat(falses(dimz), trues(sum(ncells)*nparams)),
    x0=vcat([0., 30., 0. + eps(), 0., 0., 1. - eps(), 0.008], θy0))
model = optimize(data, options0; iterations=2, outer_iterations=1)

options = neuraloptions(ncells=ncells, x0=pulse_input_DDM.flatten(model.θ))
model = optimize(data, options, n; iterations=2, outer_iterations=1)</code></pre><pre><code class="language-none">neuralDDM{θneural{θz{Float64},Array{Array{Sigmoid{Float64},1},1}},Array{Array{neuraldata,1},1}}
  θ: θneural{θz{Float64},Array{Array{Sigmoid{Float64},1},1}}
  data: Array{Array{neuraldata,1}}((2,))
</code></pre><h3><a class="nav-anchor" id="Compute-Hessian-and-the-confidence-interavls-1" href="#Compute-Hessian-and-the-confidence-interavls-1">Compute Hessian and the confidence interavls</a></h3><p>Blah blah blah</p><pre><code class="language-julia">H = Hessian(model, n, chuck_size=4)
CI, HPSD = CIs(model, H);</code></pre><pre><code class="language-none">┌ Warning: Hessian is not positive definite. Approximated by closest PSD matrix.
│             ||ϵ||/||H|| is 4.888548456033988
└ @ pulse_input_DDM ~/build/Brody-Lab/pulse_input_DDM/src/base_model.jl:15</code></pre><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../recover_choice_model/"><span class="direction">Previous</span><span class="title">Fitting a choice model</span></a><a class="next" href="../../man/vpn_is_annoying/"><span class="direction">Next</span><span class="title">Efficient Remote SSH</span></a></footer></article></body></html>
